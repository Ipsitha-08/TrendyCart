<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Products - TrendyCart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body onload="checkAuth()">
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">TrendyCart</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link active" href="products.html">Products</a></li>
          <li class="nav-item"><a class="nav-link" href="wishlist.html">Wishlist</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="logout()">Logout</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container py-5">
    <h2 class="mb-4">Browse All Products</h2>

    <!-- Filters -->
    <div class="row mb-4">
      <div class="col-md-3">
        <select id="categoryFilter" class="form-select">
          <option value="all">All Categories</option>
          <option value="clothing">Clothing</option>
          <option value="footwear">Footwear</option>
          <option value="accessories">Accessories</option>
        </select>
      </div>
      <div class="col-md-3">
        <select id="brandFilter" class="form-select">
          <option value="all">All Brands</option>
          <option value="Zara">Zara</option>
          <option value="Nike">Nike</option>
          <option value="H&M">H&M</option>
        </select>
      </div>
      <div class="col-md-3">
        <select id="priceFilter" class="form-select">
          <option value="all">All Prices</option>
          <option value="0-500">Under ₹500</option>
          <option value="500-1000">₹500 - ₹1000</option>
          <option value="1000">Above ₹1000</option>
        </select>
      </div>
      <div class="col-md-3">
        <button class="btn btn-dark w-100" onclick="applyFilters()">Apply Filters</button>
      </div>
    </div>

    <!-- Product Display -->
    <div class="row" id="product-list">
      <!-- Products go here -->
    </div>
  </div>

  <script src="js/auth.js"></script>
  <script>
    const products = [
      { id: 1, title: "Classic White T-Shirt", price: 499, brand: "Zara", category: "clothing", image: "images/tshirt1.jpg" },
      { id: 2, title: "Blue Denim Jacket", price: 1299, brand: "H&M", category: "clothing", image: "images/jacket1.jpg" },
      { id: 3, title: "Stylish Sneakers", price: 1499, brand: "Nike", category: "footwear", image: "images/shoes1.jpg" },
      { id: 4, title: "Leather Belt", price: 699, brand: "Zara", category: "accessories", image: "images/belt1.jpg" },
      { id: 5, title: "Running Shoes", price: 999, brand: "Nike", category: "footwear", image: "images/shoes2.jpg" }
    ];

    function renderProducts(productList) {
      const container = document.getElementById("product-list");
      container.innerHTML = "";
      if (productList.length === 0) {
        container.innerHTML = `<p>No products match your filter.</p>`;
        return;
      }
      productList.forEach(p => {
        const div = document.createElement("div");
        div.className = "col-md-4 mb-4";
        div.innerHTML = `
          <div class="card h-100 shadow-sm">
            <img src="${p.image}" class="card-img-top" alt="${p.title}">
            <div class="card-body">
              <h5 class="card-title">${p.title}</h5>
              <p class="card-text">₹${p.price} <br><small>${p.brand} - ${p.category}</small></p>
              <select class="form-select mb-2">
                <option selected disabled>Select Size</option>
                <option>S</option>
                <option>M</option>
                <option>L</option>
              </select>
              <button class="btn btn-outline-primary w-100 mb-2" onclick="addToWishlist(${p.id})">Add to Wishlist</button>
              <a href="checkout.html" class="btn btn-dark w-100">Buy Now</a>
            </div>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function applyFilters() {
      const cat = document.getElementById("categoryFilter").value;
      const brand = document.getElementById("brandFilter").value;
      const price = document.getElementById("priceFilter").value;

      let filtered = products;
      if (cat !== "all") filtered = filtered.filter(p => p.category === cat);
      if (brand !== "all") filtered = filtered.filter(p => p.brand === brand);
      if (price !== "all") {
        if (price === "0-500") filtered = filtered.filter(p => p.price < 500);
        else if (price === "500-1000") filtered = filtered.filter(p => p.price >= 500 && p.price <= 1000);
        else filtered = filtered.filter(p => p.price > 1000);
      }

      renderProducts(filtered);
    }

    function addToWishlist(id) {
      const user = localStorage.getItem("user");
      let wishlists = JSON.parse(localStorage.getItem("wishlists") || '{}');
      if (!wishlists[user]) wishlists[user] = [];
      if (!wishlists[user].includes(id)) {
        wishlists[user].push(id);
        localStorage.setItem("wishlists", JSON.stringify(wishlists));
        alert("Added to wishlist!");
      }
    }

    document.addEventListener("DOMContentLoaded", () => renderProducts(products));
  </script>
</body>
</html>
